
name: diff

on: push

jobs:
  changed_files:
    runs-on: ubuntu-latest  # windows-latest || macos-latest
    name: Test changed-files
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 2  # OR "2" -> To retrieve the preceding commit.
      - name: Get affected project
        run: node scripts/aff.js
      - name: Get changed files
        shell: bash
        run: |
          git fetch origin main
          AFFECTED=$(git diff origin/main..HEAD --name-only -- tests-examples/)
          components=(`echo ${AFFECTED}`)
          for s in "${!components[@]}"; do
              component=${arr[$s]#tests-examples/}
              components[$s]=${component%/*}/
          done

          FILES=${components[@]}
          echo "$FILES"
          chmod 777 scripts/test.sh
          ./scripts/test.sh